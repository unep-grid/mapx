{
  "git": {
    "commitMessage": "chore: release v${version}",
    "tagName": "${version}",
    "pushRepo": "github",
    "requireUpstream": false
  },
  "npm": {
    "publish": false
  },
  "plugins": {
    "@release-it/conventional-changelog": {
      "preset": "angular",
      "infile": "CHANGELOG.md",
      "types": [
        {"type": "feat", "section": "Features"},
        {"type": "fix", "section": "Bug Fixes"},
        {"type": "chore", "section": "Maintenance"},
        {"type": "docs", "section": "Documentation"},
        {"type": "style", "section": "Styling"},
        {"type": "refactor", "section": "Refactoring"},
        {"type": "perf", "section": "Performance"},
        {"type": "test", "section": "Testing"}
      ]
    }
  },
  "hooks": {
    "before:init": [
      "npm run lint --prefix ./app",
      "npm run lint --prefix ./api"
    ],
    "before:bump": [
      "node -e \"let pkg = require('./app/package.json'); pkg.version = '${version}'; require('fs').writeFileSync('./app/package.json', JSON.stringify(pkg, null, 2) + '\\n')\"",
      "node -e \"let pkg = require('./api/package.json'); pkg.version = '${version}'; require('fs').writeFileSync('./api/package.json', JSON.stringify(pkg, null, 2) + '\\n')\"",
      "node -e \"let pkg = require('./app/src/js/sdk/package.json'); pkg.version = '${version}'; require('fs').writeFileSync('./app/src/js/sdk/package.json', JSON.stringify(pkg, null, 2) + '\\n')\"",
      "echo '${version}' > version.txt",
      "yq -o='yaml' -i '.services.app.image=\"fredmoser/mapx_app:${version}\"' docker-compose.yml",
      "yq -o='yaml' -i '.services.app_dev.image=\"fredmoser/mapx_app:${version}\"' docker-compose.yml",
      "yq -o='yaml' -i '.services.api.image=\"fredmoser/mapx_api:${version}\"' docker-compose.yml",
      "yq -o='yaml' -i '.services.api_dev.image=\"fredmoser/mapx_api:${version}\"' docker-compose.yml"
    ],
    "after:bump": [
      "cd ./app/src/js/sdk && npm run prod",
      "cd ./app && npm run prod",
      "cd ./api && npm run prod"
    ]
  }
}
